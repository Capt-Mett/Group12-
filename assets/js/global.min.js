function download(e,t){var n=document.createElement("a");n.download=t,n.href=e,document.body.appendChild(n),n.click(),document.body.removeChild(n),delete n}GetFilenameFromUrl=e=>CheckIsNotNullOrEmpty(e)?e.substring(e.lastIndexOf("/")+1):"";const bracketPairs={"[":"]","{":"}","(":")"},closingBrackets=new Set(Object.values(bracketPairs));function areBracketsBalanced(e){if(null==e||""==e)return!0;{const t=[];for(char of e){if(closingBrackets.has(char)){if(char!==t[t.length-1])return!1;t.pop()}char in bracketPairs&&t.push(bracketPairs[char])}return 0===t.length}}function isInt(e){return Number(e)===e&&e%1==0}function isFloat(e){return Number(e)===e&&e%1!=0}var stringToHTML=function(e){return(new DOMParser).parseFromString(e,"text/html").body};function isJson(e){try{JSON.parse(e)}catch(e){return!1}return!0}var splitTest=e=>e.split("\\").pop().split("/").pop();function isURL(e){var t=new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i");return e.length<2083&&t.test(e)}function GetFileextesion(e){return CheckIsNotNullOrEmpty(e)?e.substr(e.lastIndexOf(".")+1):""}function GetFileName(e){return CheckIsNotNullOrEmpty(e)?e.replace(/\.[^/.]+$/,""):""}function CheckIsNotNullOrEmpty(e){return(void 0!==e||null!==e)&&null!=e&&""!=e}function Cint(e){return null==e||""===e||void 0===e?0:(e=e.toString().replace(",",""),e=parseInt(e),isNaN(e)?0:e)}function isValidDate(e){return e&&"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e)}function getParameterByName(e,t=window.location.href){e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function getRndInteger(e,t){return Math.floor(Math.random()*(t-e+1))+e}function roundToTwo(e){return+(Math.round(e+"e+2")+"e-2")}function getTimeZone(){var e=(new Date).getTimezoneOffset(),t=Math.abs(e);return(e<0?"+":"-")+("00"+Math.floor(t/60)).slice(-2)+":"+("00"+t%60).slice(-2)}function ActiveSuccessPop(e,t,n){Swal.fire({icon:"success",title:void 0!==e&&null!=e?e:"Completed...",html:void 0!==t&&null!=t?t:"Your Data is Safe now",onClose:null!==typeof n&&void 0!==n&&"function"==typeof n?n:function(){}})}function ActiveAlertPop(e,t,n){Swal.fire({icon:"error",title:void 0!==e&&null!=e?e:"Oops...",html:void 0!==t&&null!=t?t:"Something went wrong!",onClose:null!==typeof n&&void 0!==n&&"function"==typeof n?n:function(){}})}function ActiveInfoPop(e,t){Swal.fire({icon:"info",title:void 0!==e&&null!=e?e:"Oops...",html:void 0!==t&&null!=t?t:"Something went wrong!"})}function DefaultInternalServer(){ActiveAlertPop("Error","Internal Server Error 500")}function validateEmail(e){return e.match(/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)}function validateEmailAddress(e){return new RegExp("[a-z0-9]+@[a-z]+.[a-z]{2,3}").test(e)}function Phonenumber(e){return 10===e.match(/\d/g).length}function active_numberOnly(){ActiveNumberOnly()}Object.filter=(e,t)=>Object.keys(e).filter((n=>t(e[n]))).reduce(((t,n)=>(t[n]=e[n],t)),{}),Date.prototype.addHours=function(e){return this.setHours(this.getHours()+e),this};let ReverseReflexText=e=>CheckIsNotNullOrEmpty(e)?e.split("").reverse().join(""):"";function ActiveNumberOnlyOnlyNumber(){$(".numberOnly").on("keypress",(function(e){var t=String.fromCharCode(e.which);return!(46!=e.keyCode&&!/[0-9]/g.test(t))})),$(".numberOnly").on("paste",(function(e){e.preventDefault()}))}function ActiveNumberOnly(){$(".numberOnly").on("keypress",(function(e){var t=String.fromCharCode(e.which);return!(45!=e.keyCode&&46!=e.keyCode&&!/[0-9]/g.test(t))})),$(".numberOnly").on("paste",(function(e){e.preventDefault()}))}function Active_numberOnly_with_cancopy(){ActiveNumberOnlyWithCanCopy()}function ActiveNumberOnlyWithCanCopy(){$(".numberOnly").on("keypress",(function(e){var t=String.fromCharCode(e.which);return!(45!=e.keyCode&&46!=e.keyCode&&!/[0-9]/g.test(t))}))}function active_thai_eng(){ActiveThaiEng()}function ActiveThaiEng(){$(".eng_thai_only").on("keypress",(function(e){if(39==e.keyCode||34==e.keyCode)return!1;var t=String.fromCharCode(e.which);return!(32!=e.keyCode&&8!=e.keyCode&&!/[\u0E00-\u0E7Fa-zA-Z0-9-!@#$%^&*+_./\\=()\[\]{}]/g.test(t))})),$(".eng_thai_only").on("paste",(function(e){e.preventDefault()}))}function MatchThatChar(e){if(CheckIsNotNullOrEmpty(e)){let t=/([\u0E00-\u0E7F])/g;return e.match(t)}return!1}function MatchThatCharAndDanger(e){if(CheckIsNotNullOrEmpty(e)){let t=/([\u0E00-\u0E7F-!@#$%^&*+./\\=()\[\]{}])/g;return e.match(t)}return!1}function ActiveThaiEngCanCopy(){$(".eng_thai_only").on("keypress",(function(e){if(39==e.keyCode||34==e.keyCode)return!1;var t=String.fromCharCode(e.which);return!(32!=e.keyCode&&8!=e.keyCode&&!/[\u0E00-\u0E7Fa-zA-Z0-9-!@#$%^&*+_./\\=()\[\]{}]/g.test(t))}))}function ActiveEngNumberOnlyCanCopy(){$(".EngNumberOnly").on("keypress",(function(e){if(39==e.keyCode||34==e.keyCode)return!1;var t=String.fromCharCode(e.which);return!(32!=e.keyCode&&8!=e.keyCode&&!/[a-zA-Z0-9]/g.test(t))}))}function Active_thai_eng_with_cancopy(){ActiveThaiEngWithCanCopy()}function ActiveThaiEngWithCanCopy(){$(".eng_thai_only").on("keypress",(function(e){if(39==e.keyCode||34==e.keyCode)return!1;var t=String.fromCharCode(e.which);return!(32!=e.keyCode&&8!=e.keyCode&&!/[\u0E00-\u0E7Fa-zA-Z0-9-!@#$%^&*+_./\\=()\[\]{}]/g.test(t))}))}function ExcelDateToJSDate(e){return new Date(Math.round(86400*(e-25568)*1e3)).toISOString().split("T")[0]}function GetProtocolAndUrl(e){return window.location.protocol+"//"+window.location.host+(CheckIsNotNullOrEmpty(window.location.pathname)?window.location.pathname:"")+(CheckIsNotNullOrEmpty(e)?"/"+e:"CampaignString")}function GetProtocalANdUrl(e){return GetProtocolAndUrl(e)}function GetProtocolANdUrlNoFileName(e){return window.location.origin+(CheckIsNotNullOrEmpty(e)?"/"+e:"CampaignString")}function HilightStringMatch(e,t){if(Cint(e)>0&&(e=e.toString()),void 0!==e&&null!=e&&e.length>0&&void 0!==e&&null!=e&&e.length>0){let n=new RegExp(t,"gi");return e.replace(n,(function(e){return'<b Class="HilightBlue">'+e+"</b>"}))}return""}function ReBuildDateTime(e){if(CheckIsNotNullOrEmpty(e)&&"function"==typeof moment&&""!=e&&(e=moment(e).format("YYYY-MM-DD HH:mm:ss",!0)),moment(e).year()<1e3)return"";if(!CheckIsNotNullOrEmpty(e))return"";{let t=(e=(e=e.replace("T"," ")).replace("Z","")).split(".");null!=t[0]&&""!=t[0]&&(e=t[0])}return e}function preg_quote(e){return(e+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1")}function parse_query_string(e){for(var t=e.split("&"),n={},r=0;r<t.length;r++){var o=t[r].split("="),i=decodeURIComponent(o[0]),a=decodeURIComponent(o[1]);if(void 0===n[i])n[i]=decodeURIComponent(a);else if("string"==typeof n[i]){var c=[n[i],decodeURIComponent(a)];n[i]=c}else n[i].push(decodeURIComponent(a))}return n}function Number2Digit(e){return e>9?""+e:"0"+e}function getUrlVars(){var e={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(t,n,r){e[n]=r}));return e}function makeid(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<e;r++)t+=n.charAt(Math.floor(62*Math.random()));return t}function makeNum(e){for(var t="",n="0123456789",r=0;r<e;r++)t+=n.charAt(Math.floor(10*Math.random()));return parseInt(t)}function readURL(e,t,n,r,o){if(e.files&&e.files[0]){if("image/jpeg"!=e.files[0].type&&"image/png"!=e.files[0].type)return alert("Support only jpeg file and png file"),void n();if(e.files[0].size>1048576)return alert("Support maximum size 1 mb"),void n();$(r).length>0&&$(r).html(e.files[0].name);var i=o,a=new FormData;a.append("token",i.Token),a.append("data",e.files[0]),a.append("temporary",!0);var c="/api/upload";i.BuzzebeesAPI&&i.BuzzebeesAPI.toLowerCase().indexOf("service")>0&&(c="/upload");var u={url:i.BuzzebeesAPI+c,method:"POST",timeout:0,data:a,cache:!1,contentType:!1,processData:!1,headers:{},success:function(e){t(e)},error:function(e,t,r){alert("Error,please try again."),n()}};$.ajax(u).done((function(e){}))}}function FireConfirm(e,t){Swal.fire({title:CheckIsNotNullOrEmpty(t)&&""!=t?t:CheckIsNotNullOrEmpty(e.ConfirmTitle)?e.ConfirmTitle:"N/A",showDenyButton:!1,showCancelButton:!0,confirmButtonText:"Confirm",denyButtonText:"Don't save"}).then((t=>{t.isConfirmed?void 0!==e&&null!=e&&void 0!==e.ConfirmCallBack&&"function"==typeof e.ConfirmCallBack?(CheckIsNotNullOrEmpty(e.ByPassSuccess)&&e.ByPassSuccess||(CheckIsNotNullOrEmpty(e.ByPassSuccess)?Swal.fire(e.ViewBag.TitleSuccess,"","Success"):Swal.fire("Ok!","","Success")),e.ConfirmCallBack(),e.$apply()):CheckIsNotNullOrEmpty(e)&&e.ByPassSuccess||Swal.fire("Ok!","","Success"):(t.isDenied,void 0!==e&&null!=e&&void 0!==e.CancelCallBack&&"function"==typeof e.CancelCallBack&&(e.CancelCallBack(),e.$apply()))}))}function EventNumNoSpaceIntegerOnly(){$(".DigitOnlyInteger").on("keypress",(function(e){var t=String.fromCharCode(e.which);return!(8!=e.keyCode&&37!=e.keyCode&&39!=e.keyCode&&!/[0-9]/g.test(t))})),$(".DigitOnlyInteger").on("paste",(function(e){e.preventDefault()}))}function EventNumNoSpace(){$(".DigitOnly").on("keypress",(function(e){var t=String.fromCharCode(e.which);return!(8!=e.keyCode&&37!=e.keyCode&&39!=e.keyCode&&!/[0-9]/g.test(t))})),$(".DigitOnly").on("paste",(function(e){e.preventDefault()}))}function active_eng_nospace(){ActiveEngNoSpace()}function ActiveEngNoSpace(){$(".active_eng_nospace").on("keypress",(function(e){var t=String.fromCharCode(e.which);return 39!=e.keyCode&&34!=e.keyCode&&!(8!=e.keyCode&&37!=e.keyCode&&39!=e.keyCode&&!/[A-Za-z0-9_]/g.test(t))})),$(".active_eng_nospace").on("paste",(function(e){}))}function active_number_eng_nospace(){$(".active_number_eng_nospace").on("keypress",(function(e){var t=String.fromCharCode(e.which);return 39!=e.keyCode&&34!=e.keyCode&&!(8!=e.keyCode&&37!=e.keyCode&&39!=e.keyCode&&!/[A-Za-z0-9]/g.test(t))})),$(".active_number_eng_nospace").on("paste",(function(e){}))}function Active_Block_Ui(){ActiveBlockUi()}function ActiveBlockUi(){$.blockUI({message:null}),setTimeout($.unblockUI,35e3)}Object.size=function(e){var t,n=0;for(t in e)e.hasOwnProperty(t)&&n++;return n};const ActiveBlockUiAgument=e=>{Cint(e)>0&&(e=60*e*1e3,$.blockUI({message:null}),setTimeout($.unblockUI,e))};function ActiveConfirm(){Swal.fire({title:"Are you sure?",text:"This Operation Take A lot of time",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Let's do it"}).then((e=>{e.isConfirmed&&ActiveBlockUi()}))}function DisplayComplete(e){toastr.options={closeButton:!0,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.success(e)}function DisplayError(e){toastr.options={closeButton:!0,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.error(e)}function Active_Confirm(){ActiveConfirm()}function getBusinessDatesCount(e,t){for(var n=0,r=new Date(e);r<=t;){var o=r.getDay();6!=o&&0!=o&&n++,r.setDate(r.getDate()+1)}return n}function ReplaceThaiAndEnglishStringSpaceCharacter(e){if(void 0===e||null==e||""==e)return"";return e.replace(/[\u0E00-\u0E7Fa-zA-Z-!@#$%^&*+_./\\=()\[\]{}\s+\s ]/g,"")}function RebuildNumberFromAnyStringMessage(e){if(void 0===e||null==e||""==e)return"";var t=e.match(/\d+/g);if(t){let e="";return t.forEach(((t,n)=>{e+=t})),e}return""}function CalculationBorderOfShape(e,t,n){return CheckIsNotNullOrEmpty(e)&&CheckIsNotNullOrEmpty(t)&&CheckIsNotNullOrEmpty(BorderSide)?2*(e+e+2*n):null}function MoneyInterestBalance(e,t,n){return CheckIsNotNullOrEmpty(e)&&CheckIsNotNullOrEmpty(t)&&CheckIsNotNullOrEmpty(n)?e*(t=t<1?t+1:t)**n:null}function ExcelDateToJSDateVer2(e){var t=Math.floor(e-25569),n=new Date(1e3*(86400*t)),r=e-Math.floor(e)+1e-7,o=Math.floor(86400*r),i=o%60;o-=i;var a=Math.floor(o/3600),c=Math.floor(o/60)%60;return new Date(n.getFullYear(),n.getMonth(),n.getDate(),a,c,i)}const ConvertFirstToCap=e=>{if(null==e||null==e)return"";const t=e.split(" ");for(var n=0;n<t.length;n++)t[n]=t[n].charAt(0).toUpperCase()+t[n].slice(1);return t.join(" ")},array_column=(e,t)=>e.map((e=>e[t])),copyTextToClipboard=e=>navigator?.clipboard?.writeText?navigator.clipboard.writeText(e):Promise.reject("The Clipboard API is not available."),format=(e,t)=>{let n=0;const r=e.toString();return t.replace(/#/g,(e=>r[n++]))},isoTimeStringToLocalTimeJs=e=>CheckIsNotNullOrEmpty(e)?new Date(e.slice(0,-1)):null,imageUrlToBase64=async e=>{const t=await fetch(e),n=await t.blob();return new Promise(((e,t)=>{const r=new FileReader;r.readAsDataURL(n),r.onloadend=()=>{const t=r.result;e(t)},r.onerror=t}))},dataURItoBlob=async e=>{for(var t=atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),o=new Uint8Array(r),i=0;i<t.length;i++)o[i]=t.charCodeAt(i);return new Blob([r],{type:n})},formatString=(e,...t)=>e.replace(/{([0-9]+)}/g,(function(e,n){return void 0===t[n]?e:t[n]})),isDateValid=e=>!isNaN(new Date(e)),CintOrIsNan=e=>null==e||""===e||void 0===e?0:(e=e.toString().replace(",",""),e=parseInt(e),isNaN(e),e),Cfloat=e=>{let t=CintOrIsNan(e);return isNaN(t)?0:CheckIsNotNullOrEmpty(e=e.toString().replace(/,/g,""))?Math.round(100*e)/100:0},Logout=()=>{localStorage.clear(),window.location="/login"},daysTag=document.querySelector(".days"),currentDate=document.querySelector(".current-date"),prevNextIcon=document.querySelectorAll(".icons span");let date=new Date,currYear=date.getFullYear(),currMonth=date.getMonth();const months=["January","February","March","April","May","June","July","August","September","October","November","December"],renderCalendar=()=>{let e=new Date(currYear,currMonth,1).getDay(),t=new Date(currYear,currMonth+1,0).getDate(),n=new Date(currYear,currMonth,t).getDay(),r=new Date(currYear,currMonth,0).getDate(),o="";for(let t=e;t>0;t--)o+=`<li class="inactive">${r-t+1}</li>`;for(let e=1;e<=t;e++){o+=`<li class="${e===date.getDate()&&currMonth===(new Date).getMonth()&&currYear===(new Date).getFullYear()?"active":""}">${e}</li>`}for(let e=n;e<6;e++)o+=`<li class="inactive">${e-n+1}</li>`;currentDate.innerText=`${months[currMonth]} ${currYear}`,daysTag.innerHTML=o};renderCalendar(),prevNextIcon.forEach((e=>{e.addEventListener("click",(()=>{currMonth="prev"===e.id?currMonth-1:currMonth+1,currMonth<0||currMonth>11?(date=new Date(currYear,currMonth,(new Date).getDate()),currYear=date.getFullYear(),currMonth=date.getMonth()):date=new Date,renderCalendar()}))}));